# æµ‹è¯•æœåŠ¡å™¨æ•°æ®åº“ç»“æ„åŒæ­¥æ‰§è¡ŒæŒ‡å—

**ç”Ÿæˆæ—¶é—´**: 2025-10-20 17:40:00
**ç›®æ ‡**: å°†æµ‹è¯•æœåŠ¡å™¨æ•°æ®åº“ç»“æ„æ›´æ–°ä¸ºä¸æœ¬åœ°Dockerä¸€è‡´
**åŸåˆ™**: åªå¢ä¸å‡ï¼Œä¿ç•™æ‰€æœ‰ç°æœ‰æ•°æ®
**è¿ç§»è„šæœ¬**: `src/main/resources/db/migration_to_test_server_20251020.sql`

---

## ğŸ” å·®å¼‚åˆ†æ

### ç¼ºå¤±çš„è¡¨ï¼ˆæµ‹è¯•æœåŠ¡å™¨éœ€è¦æ–°å»ºï¼‰

| è¡¨å | ç”¨é€” | é£é™©ç­‰çº§ | æ•°æ®ä¾èµ– |
|------|------|---------|---------|
| `file_attachments` | æ–‡ä»¶é™„ä»¶å­˜å‚¨ | ğŸŸ¢ ä½ | ç‹¬ç«‹è¡¨ï¼Œæ— ç°æœ‰æ•°æ®ä¾èµ– |
| `weekly_report_attachments` | å‘¨æŠ¥é™„ä»¶å…³è” | ğŸŸ¢ ä½ | ä¾èµ–file_attachments |
| `weekly_report_comments` | å‘¨æŠ¥è¯„è®º | ğŸŸ¢ ä½ | ä¾èµ–weekly_reports |
| `file_access_logs` | æ–‡ä»¶è®¿é—®æ—¥å¿— | ğŸŸ¢ ä½ | ä¾èµ–file_attachments |

**å®‰å…¨æ€§è¯„ä¼°**: âœ… æ‰€æœ‰è¡¨éƒ½æ˜¯æ–°å»ºï¼Œä¸æ¶‰åŠç°æœ‰æ•°æ®ä¿®æ”¹

### å­—æ®µå·®å¼‚ï¼ˆéœ€è¦ä¿®æ”¹ï¼‰

#### projectsè¡¨

| å­—æ®µ | æµ‹è¯•æœåŠ¡å™¨ | æœ¬åœ°Docker | æ“ä½œ | é£é™© |
|------|-----------|-----------|------|------|
| `name` | VARCHAR(200) | TEXT | MODIFY | ğŸŸ¢ å®‰å…¨ - æ•°æ®è‡ªåŠ¨è½¬æ¢ |
| `approval_status` | åŒ…å«'AI_APPROVED' | ä¸åŒ…å«'AI_APPROVED' | MODIFY | ğŸŸ¡ **éœ€æ£€æŸ¥** - ç¡®ä¿æ— æ•°æ®ä½¿ç”¨è¯¥å€¼ |

**å…³é”®é£é™©ç‚¹**: `approval_status`æšä¸¾ä¿®æ”¹

---

## âš ï¸ æ‰§è¡Œå‰å¿…é¡»æ£€æŸ¥

### ğŸ”´ å…³é”®æ£€æŸ¥: approval_statusæ•°æ®éªŒè¯

**ç›®çš„**: ç¡®ä¿æ²¡æœ‰æ•°æ®ä½¿ç”¨'AI_APPROVED'çŠ¶æ€

**æ£€æŸ¥å‘½ä»¤**:
```bash
sshpass -p 'To1YHvWPvyX157jf38' ssh -o StrictHostKeyChecking=no root@23.95.193.155 \
  "docker exec weekly-report-mysql mysql -u root -prootpass123 -e \"
    USE weekly_report_system;
    SELECT approval_status, COUNT(*) as count
    FROM projects
    GROUP BY approval_status;
  \""
```

**æœŸæœ›ç»“æœ**:
- âœ… å¦‚æœæ²¡æœ‰'AI_APPROVED'è®°å½• â†’ å¯ä»¥å®‰å…¨æ‰§è¡Œè¿ç§»
- âŒ å¦‚æœæœ‰'AI_APPROVED'è®°å½• â†’ **å¿…é¡»å…ˆæ‰‹åŠ¨å¤„ç†è¿™äº›æ•°æ®**

**æ•°æ®å¤„ç†æ–¹æ¡ˆï¼ˆå¦‚æœæœ‰AI_APPROVEDè®°å½•ï¼‰**:
```sql
-- å°†AI_APPROVEDçŠ¶æ€è¿ç§»ä¸ºAI_ANALYZING
UPDATE projects
SET approval_status = 'AI_ANALYZING'
WHERE approval_status = 'AI_APPROVED';
```

---

## ğŸ“‹ æ‰§è¡Œæ­¥éª¤

### æ­¥éª¤1: å¤‡ä»½æµ‹è¯•æœåŠ¡å™¨æ•°æ®åº“ï¼ˆå¿…é¡»ï¼ï¼‰

```bash
# 1.1 SSHç™»å½•æµ‹è¯•æœåŠ¡å™¨
ssh root@23.95.193.155
# å¯†ç : To1YHvWPvyX157jf38

# 1.2 åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p /root/database-backups

# 1.3 å¯¼å‡ºå®Œæ•´æ•°æ®åº“å¤‡ä»½
docker exec weekly-report-mysql mysqldump -u root -prootpass123 \
  --single-transaction \
  --routines \
  --triggers \
  --events \
  weekly_report_system \
  > /root/database-backups/weekly_report_system_backup_$(date +%Y%m%d_%H%M%S).sql

# 1.4 éªŒè¯å¤‡ä»½æ–‡ä»¶
ls -lh /root/database-backups/
# åº”è¯¥çœ‹åˆ°æ–°åˆ›å»ºçš„å¤‡ä»½æ–‡ä»¶

# 1.5 æµ‹è¯•å¤‡ä»½å¯æ¢å¤æ€§ï¼ˆå¯é€‰ä½†å¼ºçƒˆæ¨èï¼‰
docker exec weekly-report-mysql mysql -u root -prootpass123 \
  -e "CREATE DATABASE IF NOT EXISTS backup_test;"

docker exec -i weekly-report-mysql mysql -u root -prootpass123 backup_test \
  < /root/database-backups/weekly_report_system_backup_*.sql

docker exec weekly-report-mysql mysql -u root -prootpass123 \
  -e "DROP DATABASE backup_test;"
```

**éªŒè¯æˆåŠŸæ ‡å¿—**: å¤‡ä»½æ–‡ä»¶å¤§å° > 1KBï¼Œä¸”å¯ä»¥æˆåŠŸå¯¼å…¥

---

### æ­¥éª¤2: æ£€æŸ¥approval_statusæ•°æ®

```bash
# åœ¨æµ‹è¯•æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SELECT approval_status, COUNT(*) as count
  FROM projects
  GROUP BY approval_status;
"
```

**å¤„ç†é€»è¾‘**:
- **å¦‚æœæœ‰AI_APPROVED**: å…ˆæ‰§è¡Œæ•°æ®è¿ç§»
  ```sql
  UPDATE projects
  SET approval_status = 'AI_ANALYZING'
  WHERE approval_status = 'AI_APPROVED';
  ```
- **å¦‚æœæ²¡æœ‰AI_APPROVED**: ç›´æ¥è¿›å…¥æ­¥éª¤3

---

### æ­¥éª¤3: ä¸Šä¼ è¿ç§»è„šæœ¬åˆ°æµ‹è¯•æœåŠ¡å™¨

```bash
# åœ¨æœ¬åœ°æ‰§è¡Œ
scp -r /Volumes/project/Projects/WeeklyReport/backend/src/main/resources/db/migration_to_test_server_20251020.sql \
  root@23.95.193.155:/root/
```

**éªŒè¯**:
```bash
ssh root@23.95.193.155 "ls -lh /root/migration_to_test_server_20251020.sql"
```

---

### æ­¥éª¤4: æ‰§è¡Œè¿ç§»è„šæœ¬

```bash
# SSHç™»å½•æµ‹è¯•æœåŠ¡å™¨
ssh root@23.95.193.155

# æ‰§è¡Œè¿ç§»è„šæœ¬
docker exec -i weekly-report-mysql mysql -u root -prootpass123 weekly_report_system \
  < /root/migration_to_test_server_20251020.sql

# æŸ¥çœ‹æ‰§è¡Œç»“æœ
echo "è¿ç§»è„šæœ¬æ‰§è¡Œå®Œæˆï¼Œæ£€æŸ¥ç»“æœ..."
```

**é¢„æœŸè¾“å‡º**:
```
Query OK, 0 rows affected (0.05 sec)  # ALTER TABLE projectsæˆåŠŸ
Query OK, 0 rows affected (0.02 sec)  # CREATE TABLE file_attachmentsæˆåŠŸ
Query OK, 0 rows affected (0.02 sec)  # CREATE TABLE weekly_report_attachmentsæˆåŠŸ
Query OK, 0 rows affected (0.02 sec)  # CREATE TABLE weekly_report_commentsæˆåŠŸ
Query OK, 0 rows affected (0.02 sec)  # CREATE TABLE file_access_logsæˆåŠŸ
```

---

### æ­¥éª¤5: éªŒè¯è¿ç§»ç»“æœ

```bash
# 5.1 æ£€æŸ¥è¡¨åˆ—è¡¨
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SHOW TABLES;
"

# åº”è¯¥çœ‹åˆ°12ä¸ªè¡¨ï¼ˆä¸æœ¬åœ°Dockerä¸€è‡´ï¼‰:
# - ai_analysis_results
# - dev_task_reports
# - file_access_logs          â† æ–°å¢
# - file_attachments           â† æ–°å¢
# - project_phases
# - projects
# - task_reports
# - tasks
# - users
# - weekly_report_attachments  â† æ–°å¢
# - weekly_report_comments     â† æ–°å¢
# - weekly_reports

# 5.2 éªŒè¯projectsè¡¨å­—æ®µ
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  DESCRIBE projects;
" | grep -E "name|approval_status"

# åº”è¯¥çœ‹åˆ°:
# name: text
# approval_status: enum(...ä¸åŒ…å«AI_APPROVED...)

# 5.3 éªŒè¯æ•°æ®å®Œæ•´æ€§
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SELECT COUNT(*) as total_users FROM users;
  SELECT COUNT(*) as total_projects FROM projects;
  SELECT COUNT(*) as total_reports FROM weekly_reports;
"

# æ•°æ®æ•°é‡åº”è¯¥ä¸è¿ç§»å‰ä¸€è‡´

# 5.4 éªŒè¯æ–°è¡¨ä¸ºç©º
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SELECT
    (SELECT COUNT(*) FROM file_attachments) as file_attachments,
    (SELECT COUNT(*) FROM weekly_report_attachments) as report_attachments,
    (SELECT COUNT(*) FROM weekly_report_comments) as comments,
    (SELECT COUNT(*) FROM file_access_logs) as access_logs;
"

# åº”è¯¥å…¨éƒ¨ä¸º0ï¼ˆæ–°è¡¨æ— æ•°æ®ï¼‰
```

---

## ğŸ”’ å®‰å…¨æ£€æŸ¥æ¸…å•

### æ‰§è¡Œå‰æ£€æŸ¥

- [ ] âœ… å·²å¤‡ä»½æµ‹è¯•æœåŠ¡å™¨æ•°æ®åº“åˆ° `/root/database-backups/`
- [ ] âœ… å·²éªŒè¯å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
- [ ] âœ… å·²æ£€æŸ¥projectsè¡¨ä¸­æ— 'AI_APPROVED'çŠ¶æ€æ•°æ®
- [ ] âœ… å·²ä¸Šä¼ è¿ç§»è„šæœ¬åˆ°æµ‹è¯•æœåŠ¡å™¨
- [ ] âœ… å·²ç¡®è®¤å½“å‰æ—¶é—´éä¸šåŠ¡é«˜å³°æœŸ

### æ‰§è¡Œä¸­ç›‘æ§

- [ ] âœ… è§‚å¯Ÿæ¯æ¡SQLè¯­å¥çš„æ‰§è¡Œç»“æœ
- [ ] âœ… æ£€æŸ¥æ˜¯å¦æœ‰ERRORé”™è¯¯
- [ ] âœ… è®°å½•æ‰§è¡Œæ—¶é—´å’Œå½±å“è¡Œæ•°

### æ‰§è¡ŒåéªŒè¯

- [ ] âœ… è¡¨æ•°é‡æ­£ç¡®ï¼ˆ12ä¸ªè¡¨ï¼‰
- [ ] âœ… projects.nameå­—æ®µç±»å‹ä¸ºTEXT
- [ ] âœ… projects.approval_statusä¸åŒ…å«AI_APPROVED
- [ ] âœ… æ–°å¢4ä¸ªè¡¨å­˜åœ¨ä¸”ä¸ºç©º
- [ ] âœ… ç°æœ‰æ•°æ®æ•°é‡ä¸å˜
- [ ] âœ… å¤–é”®çº¦æŸæ­£ç¡®åˆ›å»º
- [ ] âœ… ç´¢å¼•æ­£ç¡®åˆ›å»º

---

## ğŸš¨ å›æ»šæ–¹æ¡ˆ

### å¦‚æœè¿ç§»å¤±è´¥

**æ–¹æ¡ˆ1: æ¢å¤å¤‡ä»½**
```bash
# SSHç™»å½•æµ‹è¯•æœåŠ¡å™¨
ssh root@23.95.193.155

# åœæ­¢åç«¯æœåŠ¡ï¼ˆé¿å…è¿æ¥å†²çªï¼‰
docker stop weekly-report-backend

# åˆ é™¤å½“å‰æ•°æ®åº“
docker exec weekly-report-mysql mysql -u root -prootpass123 \
  -e "DROP DATABASE weekly_report_system;"

# æ¢å¤å¤‡ä»½
docker exec weekly-report-mysql mysql -u root -prootpass123 \
  -e "CREATE DATABASE weekly_report_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

docker exec -i weekly-report-mysql mysql -u root -prootpass123 weekly_report_system \
  < /root/database-backups/weekly_report_system_backup_20251020_*.sql

# é‡å¯åç«¯æœåŠ¡
docker start weekly-report-backend
```

**æ–¹æ¡ˆ2: ä»…å›æ»šè¡¨ç»“æ„ä¿®æ”¹**
```sql
-- å›æ»šprojectsè¡¨ä¿®æ”¹
ALTER TABLE projects
  MODIFY COLUMN name VARCHAR(200) NOT NULL COMMENT 'é¡¹ç›®åç§°',
  MODIFY COLUMN approval_status ENUM(
    'AI_ANALYZING',
    'AI_APPROVED',
    'AI_REJECTED',
    'ADMIN_REVIEWING',
    'ADMIN_APPROVED',
    'ADMIN_REJECTED',
    'SUPER_ADMIN_REVIEWING',
    'SUPER_ADMIN_APPROVED',
    'SUPER_ADMIN_REJECTED',
    'FINAL_APPROVED'
  ) NOT NULL DEFAULT 'AI_ANALYZING';

-- åˆ é™¤æ–°å¢çš„è¡¨
DROP TABLE IF EXISTS file_access_logs;
DROP TABLE IF EXISTS weekly_report_attachments;
DROP TABLE IF EXISTS weekly_report_comments;
DROP TABLE IF EXISTS file_attachments;
```

---

## ğŸ“Š é¢„æœŸå½±å“

### æœåŠ¡ä¸­æ–­æ—¶é—´

- **å¤‡ä»½é˜¶æ®µ**: 0ç§’ï¼ˆåœ¨çº¿å¤‡ä»½ï¼Œä¸å½±å“æœåŠ¡ï¼‰
- **è¿ç§»æ‰§è¡Œ**: <5ç§’ï¼ˆä»…DDLæ“ä½œï¼‰
- **éªŒè¯é˜¶æ®µ**: 0ç§’ï¼ˆSELECTæŸ¥è¯¢ï¼‰

**æ€»ä¸­æ–­æ—¶é—´**: é¢„è®¡0ç§’ï¼ˆè¿ç§»æœŸé—´æœåŠ¡å¯æ­£å¸¸è¿è¡Œï¼‰

### æ•°æ®å˜æ›´

- **æ–°å¢è¡¨**: 4ä¸ªï¼ˆå…¨éƒ¨ä¸ºç©ºï¼‰
- **ä¿®æ”¹è¡¨**: 1ä¸ªï¼ˆprojectsè¡¨å­—æ®µç±»å‹ä¼˜åŒ–ï¼‰
- **æ•°æ®ä¸¢å¤±**: 0æ¡ï¼ˆåªå¢ä¸å‡ï¼‰
- **æ•°æ®è½¬æ¢**: projects.nameè‡ªåŠ¨è½¬æ¢ï¼ˆVARCHAR â†’ TEXTï¼‰

---

## ğŸ¯ æ‰§è¡Œå‘½ä»¤å¿«æ·æ¸…å•

### ä¸€é”®æ‰§è¡Œè„šæœ¬ï¼ˆå®Œæ•´æµç¨‹ï¼‰

```bash
#!/bin/bash
# æµ‹è¯•æœåŠ¡å™¨æ•°æ®åº“è¿ç§»ä¸€é”®æ‰§è¡Œè„šæœ¬

set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

echo "=========================================="
echo "æµ‹è¯•æœåŠ¡å™¨æ•°æ®åº“è¿ç§»å¼€å§‹"
echo "=========================================="

# æ­¥éª¤1: å¤‡ä»½æ•°æ®åº“
echo "æ­¥éª¤1: å¤‡ä»½æ•°æ®åº“..."
sshpass -p 'To1YHvWPvyX157jf38' ssh -o StrictHostKeyChecking=no root@23.95.193.155 \
  "mkdir -p /root/database-backups && \
   docker exec weekly-report-mysql mysqldump -u root -prootpass123 \
     --single-transaction weekly_report_system \
     > /root/database-backups/weekly_report_system_backup_\$(date +%Y%m%d_%H%M%S).sql && \
   ls -lh /root/database-backups/ | tail -1"

echo "âœ… å¤‡ä»½å®Œæˆ"

# æ­¥éª¤2: æ£€æŸ¥approval_statusæ•°æ®
echo "æ­¥éª¤2: æ£€æŸ¥approval_statusæ•°æ®..."
sshpass -p 'To1YHvWPvyX157jf38' ssh -o StrictHostKeyChecking=no root@23.95.193.155 \
  "docker exec weekly-report-mysql mysql -u root -prootpass123 -e \"
    USE weekly_report_system;
    SELECT approval_status, COUNT(*) as count
    FROM projects
    GROUP BY approval_status;
  \"" 2>&1 | grep -v "Warning"

read -p "å¦‚æœæœ‰AI_APPROVEDè®°å½•ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ(yes/no): " confirm
if [ "$confirm" != "yes" ]; then
    echo "âŒ ç”¨æˆ·å–æ¶ˆæ“ä½œ"
    exit 1
fi

# æ­¥éª¤3: ä¸Šä¼ è¿ç§»è„šæœ¬
echo "æ­¥éª¤3: ä¸Šä¼ è¿ç§»è„šæœ¬..."
scp /Volumes/project/Projects/WeeklyReport/backend/src/main/resources/db/migration_to_test_server_20251020.sql \
  root@23.95.193.155:/root/

echo "âœ… è„šæœ¬ä¸Šä¼ å®Œæˆ"

# æ­¥éª¤4: æ‰§è¡Œè¿ç§»
echo "æ­¥éª¤4: æ‰§è¡Œè¿ç§»è„šæœ¬..."
sshpass -p 'To1YHvWPvyX157jf38' ssh -o StrictHostKeyChecking=no root@23.95.193.155 \
  "docker exec -i weekly-report-mysql mysql -u root -prootpass123 weekly_report_system \
     < /root/migration_to_test_server_20251020.sql"

echo "âœ… è¿ç§»è„šæœ¬æ‰§è¡Œå®Œæˆ"

# æ­¥éª¤5: éªŒè¯ç»“æœ
echo "æ­¥éª¤5: éªŒè¯è¿ç§»ç»“æœ..."
sshpass -p 'To1YHvWPvyX157jf38' ssh -o StrictHostKeyChecking=no root@23.95.193.155 \
  "docker exec weekly-report-mysql mysql -u root -prootpass123 -e \"
    USE weekly_report_system;
    SHOW TABLES;
  \"" 2>&1 | grep -v "Warning"

echo "=========================================="
echo "âœ… æµ‹è¯•æœåŠ¡å™¨æ•°æ®åº“è¿ç§»å®Œæˆ"
echo "=========================================="
```

---

## ğŸ“– æ‰‹åŠ¨æ‰§è¡Œæ­¥éª¤ï¼ˆæ¨èï¼‰

### æ­¥éª¤1: å¤‡ä»½æ•°æ®åº“

```bash
ssh root@23.95.193.155
# å¯†ç : To1YHvWPvyX157jf38

mkdir -p /root/database-backups

docker exec weekly-report-mysql mysqldump -u root -prootpass123 \
  --single-transaction weekly_report_system \
  > /root/database-backups/weekly_report_system_backup_$(date +%Y%m%d_%H%M%S).sql

ls -lh /root/database-backups/
```

### æ­¥éª¤2: æ£€æŸ¥approval_status

```bash
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SELECT approval_status, COUNT(*) as count
  FROM projects
  GROUP BY approval_status;
"
```

**å¦‚æœæœ‰AI_APPROVEDè®°å½•**:
```bash
# å…ˆè¿ç§»æ•°æ®
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  UPDATE projects
  SET approval_status = 'AI_ANALYZING'
  WHERE approval_status = 'AI_APPROVED';
"
```

### æ­¥éª¤3: ä¸Šä¼ è¿ç§»è„šæœ¬

```bash
# é€€å‡ºSSHï¼Œåœ¨æœ¬åœ°æ‰§è¡Œ
exit

scp /Volumes/project/Projects/WeeklyReport/backend/src/main/resources/db/migration_to_test_server_20251020.sql \
  root@23.95.193.155:/root/
```

### æ­¥éª¤4: æ‰§è¡Œè¿ç§»

```bash
# é‡æ–°SSHç™»å½•
ssh root@23.95.193.155

docker exec -i weekly-report-mysql mysql -u root -prootpass123 weekly_report_system \
  < /root/migration_to_test_server_20251020.sql
```

### æ­¥éª¤5: éªŒè¯ç»“æœ

```bash
# æ£€æŸ¥è¡¨æ•°é‡
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SELECT COUNT(*) as total_tables
  FROM information_schema.tables
  WHERE table_schema = 'weekly_report_system';
"
# æœŸæœ›: 12ä¸ªè¡¨

# æ£€æŸ¥æ–°è¡¨
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SHOW TABLES LIKE '%file%';
  SHOW TABLES LIKE '%comment%';
"
# æœŸæœ›: çœ‹åˆ°file_attachments, file_access_logs, weekly_report_commentsç­‰

# æ£€æŸ¥projectsè¡¨ç»“æ„
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  DESCRIBE projects;
" | grep -E "name|approval_status"

# éªŒè¯æ•°æ®å®Œæ•´æ€§
docker exec weekly-report-mysql mysql -u root -prootpass123 -e "
  USE weekly_report_system;
  SELECT
    (SELECT COUNT(*) FROM users) as users,
    (SELECT COUNT(*) FROM projects) as projects,
    (SELECT COUNT(*) FROM weekly_reports) as reports;
"
```

---

## å¸¸è§é—®é¢˜

### Q1: è¿ç§»ä¼šå½±å“æ­£åœ¨è¿è¡Œçš„åç«¯æœåŠ¡å—ï¼Ÿ

**ç­”**: ä¼šæœ‰æçŸ­æš‚å½±å“ï¼ˆ<1ç§’ï¼‰
- DDLæ“ä½œä¼šçŸ­æš‚é”è¡¨
- å»ºè®®åœ¨ä½å³°æœŸæ‰§è¡Œ
- å¦‚æœ‰å¿…è¦ï¼Œå¯ä¸´æ—¶åœæ­¢åç«¯å®¹å™¨

### Q2: å¦‚æœprojectsè¡¨ä¸­æœ‰AI_APPROVEDæ•°æ®æ€ä¹ˆåŠï¼Ÿ

**ç­”**: å…ˆè¿ç§»æ•°æ®ï¼Œå†æ‰§è¡Œschemaä¿®æ”¹
```sql
-- è¿ç§»æ–¹æ¡ˆ1: æ”¹ä¸ºAI_ANALYZING
UPDATE projects SET approval_status = 'AI_ANALYZING'
WHERE approval_status = 'AI_APPROVED';

-- è¿ç§»æ–¹æ¡ˆ2: æ”¹ä¸ºADMIN_REVIEWING
UPDATE projects SET approval_status = 'ADMIN_REVIEWING'
WHERE approval_status = 'AI_APPROVED';
```

### Q3: æ–°å¢çš„è¡¨ä¼šç«‹å³ä½¿ç”¨å—ï¼Ÿ

**ç­”**: ä¸ä¼š
- è¿™äº›è¡¨æ˜¯æ–‡ä»¶ç®¡ç†å’Œè¯„è®ºåŠŸèƒ½
- éœ€è¦å‰ç«¯åŠŸèƒ½å¼€å‘åæ‰ä¼šæœ‰æ•°æ®
- å½“å‰åˆ›å»ºæ˜¯ä¸ºäº†schemaå®Œæ•´æ€§

### Q4: å¦‚æœè¿ç§»å¤±è´¥å¦‚ä½•æ¢å¤ï¼Ÿ

**ç­”**: ä½¿ç”¨å¤‡ä»½æ¢å¤
```bash
docker exec -i weekly-report-mysql mysql -u root -prootpass123 \
  -e "DROP DATABASE weekly_report_system;"

docker exec -i weekly-report-mysql mysql -u root -prootpass123 \
  -e "CREATE DATABASE weekly_report_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

docker exec -i weekly-report-mysql mysql -u root -prootpass123 weekly_report_system \
  < /root/database-backups/weekly_report_system_backup_20251020_*.sql
```

---

## ğŸ“ æ‰§è¡Œè®°å½•æ¨¡æ¿

```
æ‰§è¡Œæ—¶é—´: ________________
æ‰§è¡Œäººå‘˜: ________________

å¤‡ä»½ä¿¡æ¯:
- å¤‡ä»½æ–‡ä»¶: /root/database-backups/weekly_report_system_backup_YYYYMMDD_HHMMSS.sql
- å¤‡ä»½å¤§å°: _______ KB
- éªŒè¯ç»“æœ: âœ…/âŒ

approval_statusæ£€æŸ¥:
- AI_APPROVEDè®°å½•æ•°: _______
- å¤„ç†æ–¹å¼: _________________

è¿ç§»æ‰§è¡Œ:
- å¼€å§‹æ—¶é—´: __:__:__
- ç»“æŸæ—¶é—´: __:__:__
- æ‰§è¡Œç»“æœ: âœ…/âŒ

éªŒè¯ç»“æœ:
- è¡¨æ•°é‡: _______ (æœŸæœ›12)
- projects.nameç±»å‹: _______ (æœŸæœ›TEXT)
- æ•°æ®å®Œæ•´æ€§: âœ…/âŒ
- æ–°è¡¨åˆ›å»º: âœ…/âŒ

é—®é¢˜è®°å½•:
_______________________________
_______________________________
```

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-10-20 17:45:00
**è¿ç§»è„šæœ¬**: `src/main/resources/db/migration_to_test_server_20251020.sql`
**é£é™©ç­‰çº§**: ğŸŸ¡ ä¸­ç­‰ï¼ˆéœ€è¦å¤‡ä»½å’ŒéªŒè¯ï¼‰
**é¢„è®¡æ‰§è¡Œæ—¶é—´**: 5-10åˆ†é’Ÿ
