# 项目管理模块接口核对报告

## 基于 ProjectController.java 的实际接口

### 1. 创建项目
- **接口**: `POST /projects`
- **权限**: MANAGER, ADMIN, SUPER_ADMIN
- **请求体**: `ProjectCreateRequest`
  ```json
  {
    "name": "项目名称",              // ✅ required, String, 2-200字符
    "description": "项目内容",       // ❌ optional, String, <5000字符
    "members": "项目成员",          // ❌ optional, String, <5000字符
    "expectedResults": "预期结果",   // ❌ optional, String, <5000字符
    "timeline": "时间线",           // ❌ optional, String, <5000字符
    "stopLoss": "止损点",           // ❌ optional, String, <5000字符
    "phases": []                    // ❌ optional, Array<ProjectPhaseCreateRequest>
  }
  ```
- **响应**: `ProjectResponse`
  ```json
  {
    "id": 1,
    "name": "项目名称",
    "description": "项目内容",
    "members": "项目成员",
    "expectedResults": "预期结果",
    "timeline": "时间线",
    "stopLoss": "止损点",
    "createdBy": 1,
    "createdByUsername": "user1",
    "aiAnalysisId": null,
    "adminReviewerId": null,
    "superAdminReviewerId": null,
    "rejectionReason": null,
    "approvalStatus": "AI_ANALYZING",
    "status": "ACTIVE",
    "priority": "MEDIUM",
    "progress": 10,
    "phases": [],
    "aiAnalysisResult": null,
    "createdAt": "2025-10-09T10:00:00",
    "updatedAt": "2025-10-09T10:00:00"
  }
  ```

### API文档中的错误字段 ❌

文档中使用了这些**不存在**的字段：
- `projectName` ❌ 应该是 `name`
- `projectDescription` ❌ 应该是 `description`
- `startDate` ❌ 不存在这个字段
- `endDate` ❌ 不存在这个字段
- `budget` ❌ 不存在这个字段
- `priority` ❌ 创建时不需要，会自动设为MEDIUM
- `objectives` ❌ 不存在这个字段
- `expectedOutcomes` ❌ 应该是 `expectedResults`

### 2. 获取所有项目（分页）
- **接口**: `GET /projects?page=0&size=10&sortBy=createdAt&sortDir=desc`
- **权限**: MANAGER, ADMIN, SUPER_ADMIN
- **查询参数**:
  - `page` (optional, default=0): 页码
  - `size` (optional, default=10): 每页数量
  - `sortBy` (optional, default="createdAt"): 排序字段
  - `sortDir` (optional, default="desc"): 排序方向 (asc/desc)
- **响应**: `Page<ProjectResponse>`

### 3. 项目过滤查询
- **接口**: `GET /projects/filter`
- **权限**: MANAGER, ADMIN, SUPER_ADMIN
- **查询参数**:
  - `name` (optional): 项目名称
  - `status` (optional): 项目状态
  - `priority` (optional): 优先级
  - `approvalStatus` (optional): 审批状态
  - `createdBy` (optional): 创建者ID
  - `page`, `size`, `sortBy`, `sortDir`: 同上

### 4. 获取待审核项目
- **接口**: `GET /projects/pending-review`
- **权限**: ADMIN, SUPER_ADMIN
- **响应**: `List<ProjectResponse>`
- **说明**:
  - ADMIN看到待管理员审核的项目
  - SUPER_ADMIN看到待超级管理员审核的项目

### 5. 获取已通过项目
- **接口**: `GET /projects/approved`
- **权限**: ADMIN, SUPER_ADMIN
- **响应**: `List<ProjectResponse>`

### 6. 获取已拒绝项目
- **接口**: `GET /projects/rejected`
- **权限**: ADMIN, SUPER_ADMIN
- **响应**: `List<ProjectResponse>`

### 7. 获取项目详情
- **接口**: `GET /projects/{id}`
- **权限**: MANAGER, ADMIN, SUPER_ADMIN
- **路径参数**: `id` (Long) - 项目ID
- **响应**: `ProjectResponse`
- **权限说明**: MANAGER只能查看自己创建的项目

### 8. 更新项目
- **接口**: `PUT /projects/{id}`
- **权限**: MANAGER (仅创建者)
- **请求体**: `ProjectCreateRequest` (同创建项目)
- **限制**: 只有草稿或已拒绝状态的项目可以更新

### 9. 删除项目
- **接口**: `DELETE /projects/{id}`
- **权限**: MANAGER (仅创建者)
- **限制**: 只有草稿状态的项目可以删除

### 10. 提交项目进行AI分析
- **接口**: `PUT /projects/{id}/submit`
- **权限**: MANAGER (仅创建者)
- **限制**: 只有草稿或已拒绝状态的项目可以提交

### 11. 强制提交项目（跳过AI）
- **接口**: `POST /projects/{id}/force-submit`
- **权限**: MANAGER, ADMIN, SUPER_ADMIN (ADMIN以上权限)
- **说明**: 跳过AI分析，直接进入管理员审核

### 12. 重新提交项目
- **接口**: `PUT /projects/{id}/resubmit`
- **权限**: MANAGER (仅创建者)
- **请求体**: `ProjectUpdateRequest`
- **限制**: 只有已拒绝状态的项目可以重新提交

### 13. 管理员审核通过
- **接口**: `PUT /projects/{id}/approve`
- **别名**: `PUT /projects/{id}/admin-approve`
- **权限**: ADMIN
- **说明**: 管理员审批通过项目

### 14. 超级管理员最终审核
- **接口**: `PUT /projects/{id}/final-approve`
- **别名**: `PUT /projects/{id}/super-admin-approve`
- **权限**: SUPER_ADMIN
- **说明**: 超级管理员最终审批通过

### 15. 拒绝项目
- **接口**: `PUT /projects/{id}/reject`
- **权限**: ADMIN, SUPER_ADMIN
- **请求体**: String (拒绝原因)
- **说明**:
  - ADMIN可以拒绝AI通过、管理员审核中的项目
  - SUPER_ADMIN可以拒绝管理员通过的项目

### 16. 获取我的项目
- **接口**: `GET /projects/my?approvalStatus={status}`
- **权限**: MANAGER
- **查询参数**:
  - `approvalStatus` (optional): 审批状态过滤
- **响应**: `List<ProjectResponse>`

### 17. 获取待审核项目
- **接口**: `GET /projects/pending`
- **权限**: ADMIN, SUPER_ADMIN
- **响应**: `List<ProjectResponse>`
- **说明**: 与 `/pending-review` 相同

### 18. 获取已审核项目
- **接口**: `GET /projects/reviewed`
- **权限**: ADMIN, SUPER_ADMIN
- **响应**: `List<ProjectResponse>`
- **说明**: 获取当前用户审核过的项目

### 19. 获取项目阶段
- **接口**: `GET /projects/{projectId}/phases`
- **权限**: MANAGER, ADMIN, SUPER_ADMIN
- **响应**: `List<ProjectPhaseResponse>`

### 20. 创建项目阶段
- **接口**: `POST /projects/{projectId}/phases`
- **权限**: MANAGER, ADMIN, SUPER_ADMIN
- **请求体**: `ProjectPhaseCreateRequest`
- **说明**: MANAGER只能为自己创建的项目添加阶段

## 审批状态枚举

```java
public enum ApprovalStatus {
    AI_ANALYZING,            // AI分析中
    AI_APPROVED,             // AI分析通过
    AI_REJECTED,             // AI分析拒绝
    ADMIN_REVIEWING,         // 管理员审核中
    ADMIN_APPROVED,          // 管理员审核通过
    ADMIN_REJECTED,          // 管理员审核拒绝
    SUPER_ADMIN_REVIEWING,   // 超级管理员审核中
    SUPER_ADMIN_APPROVED,    // 超级管理员审核通过
    SUPER_ADMIN_REJECTED,    // 超级管理员审核拒绝
    FINAL_APPROVED           // 最终批准
}
```

## 需要更新API文档的地方

1. ✅ 创建项目接口的请求字段完全错误
2. ✅ 需要明确所有接口的权限要求
3. ✅ 需要添加查询参数说明
4. ✅ 需要说明审批状态枚举
5. ✅ 需要说明各个接口的业务限制条件
